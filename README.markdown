#Программа MCMF (Method of Continuous Molecular Fields) 

Программа предназначена для построения моделей для виртуального скрининга и его проведения на основе метода непрерывных молекулярных полей и традиционных дескрипторных подходов. Построение прогностических моделей осуществляется в рамках одноклассового, двухклассового и регрессионного подоходов на базе машин опорных векторов в реализации libSVM. 

#Параметры описания молекул

В программе реализованы следующие ядра скалярного произведения: 

* гаусс (gauss), 
* танимото (tanomoto), 
* линейное (linear), 
* электростатическое (selectrostatic),
* гидрофобное (hydrophobic), 
* стерическое (steric), 
* а также их любые линейные комбинации.
    
Некоторые ядра (первые три) работают с вычисленными дескрипторами молекулярных структур. Остальные ядра - сравнивают структуры непосредственно, минуя стадию вычисления дескрипторов. 

Доступные дескрипторные блоки:

* молекулярные отпечатки (fp2),
* спектрофоры (spectrophores),
* многоуровневые атомные окрестности (mna).

#Построение одноклассовых моделей

В качестве примера рассмотрим команду построения одноклассовой модели по прогнозированию лигандов ACE.  
./MCMF *sdf-train*=ace_ligands.sdf *sdf-test*=ace_decoys.sdf *max-iter*=1 *cv*=10 *machine*=1-svm *results*=ace.res *model*=ace *kernel*=gauss[mna],tanimoto[fp2]
 
Опции командной строки выделены шрифтом. Некоторые из них описаны далее:
   
* Активные лиганды находятся в SDF файле ace_ligands.sdf
* Приманки, на данном этапе необходимые для построения одноклассового классификатора, находятся в SDF файле ace_decoys.sdf  
* Количество случайных запусков на оптимизируемой поверхности max-iter=1. 
* Количество выборок для перекрестного контроля CV=10
* Переключатель machine пока принимает два параметра 1-svm и svr.В настоящее время тестируется и исправляется только режим одноклассового классификатора.
    
* В файл ace.res будет записан лог обучения. Все изменения параметров, данные для окончательной рок-кривой, статистика при выбранном оптимальном пороге.
* Сама модель будет сохранена в файл ace.mdl (расширение добавляется автоматически).
* Ядра указываются через запятую. Для некоторых ядер, например, Гаусс, Танимото и линейное - требуется указать дескрипторы. В данном случае модель будет построена с использованием линейной комбинации двух ядер: Гаусс с MNA-дескрипторами и Танимото с молекулярными отпечатками.

#Проведение виртуального скрининг

Построенную на предыдущем шаге одноклассовую модель можно использовать для проведения виртуального скрининга следующим образом:

./MCMF *prognosis*  *model*=ace.mdl *sdf-test*=ace_decoys.sdf

Используя модель ace.mdl программа MCMF вычислит значение функции одноклассового классификатора для молекул из файла ace_decoys.sdf. Для тех структур, которые прогнозируются как активные, будет напечатан заголово структуры (поле title в sdf) и рассчитанное значение. Чем оно выше, тем более тестируемая стркутура напоминает органические соединения из обучающей выборки.

#Компиляция и зависимости

Для компиляции проекта необходимо:

* [OpenBabel](http://openbabel.org/wiki/Main_Page "OpenBabel") - общедоступный пакет по хемоинформатике,
* [NlOpt] (http://ab-initio.mit.edu/wiki/index.php/NLopt "NlOpt") - пакет по методам оптимизации функций,
* [Flex] (http://flex.sourceforge.net/) - лексический анализатор,
* [Bison] (http://www.gnu.org/software/bison/ "Bison") - синтаксический анализатор.

В качестве сисетмы сборки используется CMake.





